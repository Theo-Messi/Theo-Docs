---
title: 旁路由设置
head:
  - - meta
    - name: description
      content: OpenWRT/istore os 旁路由设置
  - - meta
    - name: keywords
      content: 旁路由 OpenWRT istore os DNS
---

## 旁路由 是什么？

我们经常在各种文章和视频里面看到听到 `旁路由` 这个词，但并不清楚他究竟是何方神圣。其实 `旁路由` 这并不是一个严谨的词汇，在官方的技术用语里，正确的叫法应该是 `旁路网关`（为了方便，后续将依旧以旁路由为准）。

而所谓的 `旁路网关` ，是指挂靠在主路由网络下的一个旁系网络，他分担了一部分路由器的功能，因此被大众简称为 `旁路由` ，本质上它是一个通过 LAN 口与主路由连接的一个客户端设备。

这种主旁路由构成的网络架构可以分成两种，一种是发烧友在软路由系统中，通过虚拟化的形式，安装两套路由系统，它们各司其职，在软件层面上形成了主旁网络架构。另一种就是通过使用两个实体路由器，通过连接和配置打造的硬件形式上的主旁网络结构。虽然他们形式上有一定区别，但这种双路由系统（硬件或虚拟化）的网络布局，殊途同归，最终目的都是为了将家庭网络带宽进行合理的分配利用，并提供更强的扩展性，以实现更多强大的功能。

## 旁路由 模式的优缺点

既然我们已经简单了解了什么是 `旁路由` ，那么为什么大家会使用这种方式来构建家庭网络呢？总结来说，旁路由的有以下优点：

- 可负载性——如果你的主路由硬件配置过低，无法承担过重的扩展功能，那么旁路由可以用来分担主路由的压力，既不影响网络速度，还可以一定程度优化网络体验
- 可扩展性——旁路由可以在对当前的网络架构影响最小的情况下，扩展出新的功能，且在配置阶段可以不影响他人使用网络，非常适合在城市里合租的人员优化自己的网络
- 多功能性——旁路由同样可以安装各种插件，扩展出很多实用的功能，增强上网体验，可以安装的插件可以参照之前的文章用这些 OpenWRT 插件来武装你的路由器

当然使用 `旁路由` 的时候也需要一定的网络基础知识和额外的硬件成本支出，最重要的是你需要有耐心和动力去折腾改善家中的网络状况，如果这些都不是问题，就可以开始动手了。

## 配置 旁路由

选择好了 `旁路由` 设备后，我们就需要配置它了。根据不同的 `旁路由` 设备，配置的方法也有很多种，这里就不一一赘述，主要介绍两种配置和操作都相对简单，且对当前网络构造影响最小的方案。

### 设备自行选择网关设备

这套方案配置方法非常简单，可以在不影响当前网络的情况下进行配置，配置完成后，不同的设备只需要自己在设备中修改网络信息就可以自行选择使用 `主路由` 或者 `旁路由` 上网，非常适合 `X漂` 人士改造自己合租屋的网络，只让自己的设备使用 `旁路由` 。具体的网络架构图如下：

![旁路由设置](https://i.theojs.cn/docs/20240423222144.webp '设备自行选择网关设备')

他的配置和使用方式很简单，只需要以下几个步骤：

- 旁路由设备的 LAN 口连接主路由的 LAN 口，然后进入旁路由的配置界面
- 以 OpenWRT 系统为例，进入 `网络` - `接口` - `LAN 口`，在设置中 `协议` 选择 `静态地址` ，然后 `IPv4 地址` 设置为 `192.168.1.x`（与主路由网段相同但不冲突）
- `IPv4 网关` 填写主路由 IP（192.168.1.1），DNS 设置为主路由IP，DHCP服务器填勾选忽略接口
- 需要使用 `旁路由` 的设备，只需要将网络设置中的 `网关` 和 `DNS` 填写成 `旁路由` 的IP（192.168.1.x）即可
- 需要管理 `旁路由` 时，在浏览器输入 `旁路由` 的 IP（192.168.1.x）即可进入管理页面

**路由器配置详情可参考下图：**

![旁路由设置](https://i.theojs.cn/docs/20240423222307.webp '设备自行选择网关设备')

### 所有设备通过旁路由联网

第二个方案， `旁路由` 需要开启强制使用 DHCP，所有设备的网络流量都将通过旁路由，无需对网络内的设备进行单独设置，也无需修改光猫和主路由的设置，对当前网络的影响也较小，但需要重启路由器让配置生效，这个方案适合无需担心网络影响他人的使用。

![旁路由设置](https://i.theojs.cn/docs/20240423222353.webp '所有设备通过旁路由联网')

方案的配置也不复杂，相关步骤如下：

- 前两步与方案一相同，第三步中 `IPv4 网关` 依旧填写主路由 IP（192.168.1.1），DNS 设置为主路由IP，但要勾选 `动态 DHCP`，并勾选 `强制` 选项
- 在 `DHCP 服务器` 设置中，`IPv4 子网掩码` 设置为 `255.255.255.0`，`DHCP选项` 分别填写 `3,192.168.1.x` 与 `6,192.168.1.x` （IP 地址为你旁路由的 IP 地址）
- 设置完成后，重启 `旁路由` 和 `主路由` 即可
- 如果不再使用 `旁路由` ，只需要断开网线连接，并重启 `主路由` ，网络将重新由 `主路由` 接管，无需改动其他配置

**路由器配置详情可参考下图：**

![旁路由设置](https://i.theojs.cn/docs/20240423222443.webp '所有设备通过旁路由联网')
